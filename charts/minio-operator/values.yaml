namespace: "minio"
installCRDs: true

workload:
  image:
    registry: quay.io
    repository: minio/operator
    tag: v7.1.1
  args:
    - controller
  envs:
    - name: "OPERATOR_STS_ENABLED"
      value: "on"
  probes:
    readinessProbe:
      type: tcpSocket
      port: 4221
    livenessProbe:
      type: tcpSocket
      port: 4221
  storage:
    - name: tmp
      type: emptyDir
      mountPath: /tmp/sts

service:
  ports:
    - name: http-operator
      port: 4221
      protocol: TCP
    - name: https-sts
      port: 4223
      protocol: TCP

rbac:
  enabled: true
  roles:
    clusterRole:
      rules:
        - apiGroups:
            - apiextensions.k8s.io
          resources:
            - customresourcedefinitions
          verbs:
            - get
            - update
        - apiGroups:
            - ''
          resources:
            - persistentvolumeclaims
          verbs:
            - get
            - update
            - list
        - apiGroups:
            - ''
          resources:
            - namespaces
            - nodes
          verbs:
            - create
            - get
            - watch
            - list
        - apiGroups:
            - ''
          resources:
            - pods
            - services
            - events
            - configmaps
          verbs:
            - get
            - watch
            - create
            - list
            - delete
            - deletecollection
            - update
            - patch
        - apiGroups:
            - ''
          resources:
            - secrets
          verbs:
            - get
            - watch
            - create
            - update
            - list
            - delete
            - deletecollection
        - apiGroups:
            - ''
          resources:
            - serviceaccounts
          verbs:
            - create
            - delete
            - get
            - list
            - patch
            - update
            - watch
        - apiGroups:
            - rbac.authorization.k8s.io
          resources:
            - roles
            - rolebindings
          verbs:
            - create
            - delete
            - get
            - list
            - patch
            - update
            - watch
        - apiGroups:
            - apps
          resources:
            - statefulsets
            - deployments
            - deployments/finalizers
          verbs:
            - get
            - create
            - list
            - patch
            - watch
            - update
            - delete
        - apiGroups:
            - batch
          resources:
            - jobs
          verbs:
            - get
            - create
            - list
            - patch
            - watch
            - update
            - delete
        - apiGroups:
            - certificates.k8s.io
          resources:
            - certificatesigningrequests
            - certificatesigningrequests/approval
            - certificatesigningrequests/status
          verbs:
            - update
            - create
            - get
            - delete
            - list
        - apiGroups:
            - certificates.k8s.io
          resourceNames:
            - kubernetes.io/legacy-unknown
            - kubernetes.io/kube-apiserver-client
            - kubernetes.io/kubelet-serving
            - beta.eks.amazonaws.com/app-serving
          resources:
            - signers
          verbs:
            - approve
            - sign
        - apiGroups:
            - authentication.k8s.io
          resources:
            - tokenreviews
          verbs:
            - create
        - apiGroups:
            - minio.min.io
            - sts.min.io
            - job.min.io
          resources:
            - '*'
          verbs:
            - '*'
        - apiGroups:
            - min.io
          resources:
            - '*'
          verbs:
            - '*'
        - apiGroups:
            - monitoring.coreos.com
          resources:
            - prometheuses
            - prometheusagents
          verbs:
            - get
            - update
            - list
        - apiGroups:
            - coordination.k8s.io
          resources:
            - leases
          verbs:
            - get
            - update
            - create
        - apiGroups:
            - policy
          resources:
            - poddisruptionbudgets
          verbs:
            - create
            - delete
            - get
            - list
            - patch
            - update
            - deletecollection

storageClass:
  enabled: true
  provisioner: "kubernetes.io/no-provisioner"
  reclaimPolicy: "Retain"
  allowVolumeExpansion: "true"
  volumeBindingMode: "WaitForFirstConsumer"

extraObjects:
  - |
    apiVersion: bitnami.com/v1alpha1
    kind: SealedSecret
    metadata:
      name: minio
      namespace: minio
    spec:
      encryptedData:
        config.env: AgAKoVnfBk0jyFCTrkAtwkF08mcWt58lwXbz9iSkb8grGV9f4NF3LqAR+wMykfOmqcZ+l75gL6Cmhn1/AcpzhuBPqacbT1dM+MpQ07//N9p3IsvR9jBYSpG9fkjpf9jSzz+kuwgvA1dT4UcU5SRtSBtbKawZkfGj+ToFam73p4C5BB99QtjITXYMokxvM+OfbUaajgFhEUBFsB8x0GLVsZyM4tgDOkrC+DM2vfpN1peQFnTuujklTqnt2mMu2O/ot/jXdUBZvslzWMUIl6NdnT/qgEupAYN0q157ZakNV9gkCg4h3bDMyRRNw+2ZHUcqWbGWdFMna4P4lKzBaY7MLDdVZsFoeoIBQdqUHRxXg0KDiJE3m0QjU6+wTL0F9Botc4aMAUsoFVqneVZQXqkMXvhTwDqTOHJPVWcj2UluDNW3HoJJ347dPySXqwL6DRG1od7+jHGNrthM+mgr8ZAFYMNmNnRZk5MOGP4KrPgsvcnHOJLlYaLTkLsiTYByc53dEeF7U7Y4Ol6cjsV9IdZyPhXl0U/BkA1v5QXv1+8gOdSf9RJQp1ZHM7IUSwc4HsnB/d3V4hgopiMDw/h22R7RVksNwkiuwoDH6gvLLdSTyNT5/9rRVvPqe11y5F36E0t3Kjpi1vlb53TdDYqBa9QssW6KG7SNJZdoOJbMnCKZb2bozZXZJfPDGUwbbFe7AD01gZLLYLcDeu/6esBXXVL/GDY5QlxnEiJUUJIAigw2ZG0/Za6hSNPxg9Ice3Cr6EYYi5b4zz+ITD4HiwJV8cve24CZibFZWA==
      template:
        metadata:
          name: minio
          namespace: minio
        type: Opaque
  - |
    apiVersion: bitnami.com/v1alpha1
    kind: SealedSecret
    metadata:
      name: secret-name
      namespace: minio
    spec:
      encryptedData:
        accessKey: AgBhKA2lNfNoVhTX/XzA1RjA9fvZoWMeIjYi3+ia9Vq26/c3fhm3BMiHyNbKo1DYwHYLLsXV7bIOUUS4QRugeyvuSydBmSh0LiO2z1DIzBPUiDuVLwyzzrDqSEBsRuxt1kK279UVQxppcFHYAhU+JmdyhgwVZzhU/A6DywVNJoYU2m1mz8CgmoebKVmYHFmIcToKGM58WAp6grqfkRiV5cSDT/RFaTREFkr6B6VElJo6f8MSgiMTseaeoQ3D2K+X7D8rXxzEBj5ylXU73XSUOLhCxXmmhDNZe4Fjy3V8NNNJtRmcyIsPvkKydAnE9/Jws1Kdmw0Q/gYFo+q3+M6/ggFqMmiXpnkbG70OaqI/gKSzW6V9Zx6OEQ5Sd/rrtjuLd9ST4hxF7KN147POW84QbpUoUpIco2LDvjiQsxQiXanEZPqewsVuBaabUfP2zVxpAM93qENslU4RJmyojX4qx9E324alaTuSkP4wRZnR5WzhJJHnLcZ9T8SYDadAGWB8uxF39Wls2pW6xJpAgddLBF2uB0PxuD4hnzyymd/lXmM3Xs4nq13/NB6W6M62IGChm+2B6qCuF+e8wmnvuDgiTZT6fsZTWa8ymYPuCcvlkFah21TpaBT5HJoSJO8WKwdbNLFp9Pfb7ZAK/Zd/jjYdkrXTIvA2c08q/fmujf7J8yBq2IsT9MazDlST6owWiRd4sPMU4YIbVXlI/hqXnMdv5AyB6LDdFQ==
        secretKey: AgBtk6Mtbe2bwHV/EQSP3L/km/iRMF7QYUmmyyOKo39mW/FlUHUacJQlrjfc2WabVDGfy3Gis8GgwGzy7po4W4I6XVmLtcUoCbQw6WVjbudtSMn9sGqOuAadQev5+zHvGqqHI/Cbvl12GFRcroEnE4FqclVKrZZMGmnfyOMmmjNMs1/lL4vKskHu2ibbAL4r/26ZdEQE/9i399P2r+g6euY3MRGyX8QKWu9zYqAf7HGP6cN3ZU7LZ50yi4pmDa1fXMu8Y8uEmVH4FEsjjjB7L2PCmzPyO9W4/IshZDkUlhQriwmxurgpKf7EjScDXS6LDXI/9Wepi1KosqCPEN1iaXKGo71E3rAaCsVBUmc6gntK5ok2/yw6QCMF0ieZvzM4zQedi5D0hfyYJpzBSdhMq+aahJphT2hxOWp4+JcbViV9SQlu62AKlaVfltCvhdDw3dvzgAN8ER8EMDmJapHFwkDalPCfa8ZPwsyDKqvsw2C/ir6D0ek6v1BDHIiP1803uqtU94OAYVvALL20f/uIRtFD5kEmgzFmzipOYnqTbWgMNea629GWtDSdMGt924wlkO47nXqe2vbz6sz2bSBdjDiXSAhYLpuG3Wug/PGFIsJbb4TgLN0ZXHbAi32d/c5Qp93RC+qDJavfAvlMfCKwczHdM3kUygbgubb+qU4ntCRJkkyZds63vnBbKp9o+jcX/jLe1xeOoIXnjsPp2ojz3zSzDGWxh2jTLt4C1AvRg7RipPxbIppXxnU=
      template:
        metadata:
          name: secret-name
          namespace: minio
        type: Opaque
  - |
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: minio-pv-qszsdjpr-disk1
      labels:
        type: local
        disk: disk1
    spec:
      capacity:
        storage: 9.09Ti
      volumeMode: Filesystem
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: minio-operator
      local:
        path: /var/mnt/minio-data/disk1
      nodeAffinity:
        required:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/hostname
                  operator: In
                  values:
                    - worker-qszsdjpr
  - |
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: minio-pv-qszsdjpr-disk2
      labels:
        type: local
        disk: disk2
    spec:
      capacity:
        storage: 9.09Ti
      volumeMode: Filesystem
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: minio-operator
      local:
        path: /var/mnt/minio-data/disk2
      nodeAffinity:
        required:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/hostname
                  operator: In
                  values:
                    - worker-qszsdjpr
  - |
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: minio-pv-o8jpnslj-disk1
      labels:
        type: local
        disk: disk1
    spec:
      capacity:
        storage: 9.09Ti
      volumeMode: Filesystem
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: minio-operator
      local:
        path: /var/mnt/minio-data/disk1
      nodeAffinity:
        required:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/hostname
                  operator: In
                  values:
                    - worker-o8jpnslj
  - |
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: minio-pv-o8jpnslj-disk2
      labels:
        type: local
        disk: disk2
    spec:
      capacity:
        storage: 9.09Ti
      volumeMode: Filesystem
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: minio-operator
      local:
        path: /var/mnt/minio-data/disk2
      nodeAffinity:
        required:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/hostname
                  operator: In
                  values:
                    - worker-o8jpnslj
  - |
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: minio-pv-8spr56sk-disk1
      labels:
        type: local
        disk: disk1
    spec:
      capacity:
        storage: 9.09Ti
      volumeMode: Filesystem
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: minio-operator
      local:
        path: /var/mnt/minio-data/disk1
      nodeAffinity:
        required:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/hostname
                  operator: In
                  values:
                    - worker-8spr56sk
  - |
    apiVersion: v1
    kind: PersistentVolume
    metadata:
      name: minio-pv-8spr56sk-disk2
      labels:
        type: local
        disk: disk2
    spec:
      capacity:
        storage: 9.09Ti
      volumeMode: Filesystem
      accessModes:
        - ReadWriteOnce
      persistentVolumeReclaimPolicy: Retain
      storageClassName: minio-operator
      local:
        path: /var/mnt/minio-data/disk2
      nodeAffinity:
        required:
          nodeSelectorTerms:
            - matchExpressions:
                - key: kubernetes.io/hostname
                  operator: In
                  values:
                    - worker-8spr56sk
